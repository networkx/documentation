
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>NXEP 3 — Graph Builders &#8212; NetworkX 2.8.5 documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <link rel="canonical" href="https://networkx.org/documentation/stable/developer/nxeps/nxep-0003.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within NetworkX 2.8.5 documentation"
          href="../../_static/opensearch.xml"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="NXEP 4 — Adopting numpy.random.Generator as default random interface" href="nxep-0004.html" />
    <link rel="prev" title="NXEP 2 — API design of view slices" href="nxep-0002.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="light">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    <img src="../../_static/networkx_banner.svg" class="logo__image only-light" alt="Logo image">
    <img src="../../_static/networkx_banner.svg" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../install.html">
  Install
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../tutorial.html">
  Tutorial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../reference/index.html">
  Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../release/index.html">
  Releases
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="../index.html">
  Developer
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../auto_examples/index.html">
  Gallery
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://networkx.org/nx-guides/">Guides<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://networkx.org" rel="noopener" target="_blank" title="Home Page"><span><i class="fas fa-home"></i></span>
            <label class="sr-only">Home Page</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/networkx/networkx" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <ul class="navbar-nav">
    <li class="mr-2 dropdown">
        <button type="button" class="btn btn-version btn-sm navbar-btn dropdown-toggle" id="dLabelMore" data-toggle="dropdown">
            v2.8.5
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dLabelMore">
            <li><a href="https://networkx.org/documentation/latest/index.html">devel (latest)</a></li>
            <li><a href="https://networkx.org/documentation/stable/index.html">current (stable)</a></li>
        </ul>
    </li>
</ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../about_us.html">
   About Us
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code_of_conduct.html">
   Code of Conduct
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../values.html">
   Mission and Values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../contribute.html">
   Contributor Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../projects.html">
   Mentored Projects
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../new_contributor_faq.html">
   New Contributor FAQ
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../core_developer.html">
   Core Developer Guide
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../release.html">
   Release Process
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../deprecations.html">
   Deprecations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../roadmap.html">
   Roadmap
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="index.html">
   NXEPs
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="nxep-0000.html">
     NXEP 0 — Purpose and Process
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nxep-0001.html">
     NXEP 1 — Governance and Decision Making
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nxep-0002.html">
     NXEP 2 — API design of view slices
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     NXEP 3 — Graph Builders
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nxep-0004.html">
     NXEP 4 — Adopting
     <code class="xref py py-obj docutils literal notranslate">
      <span class="pre">
       numpy.random.Generator
      </span>
     </code>
     as default random interface
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="nxep-template.html">
     NXEP X — Template and Instructions
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>
    </div>
    
    <div class="toc-item">
      
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motivation-and-scope">
   Motivation and Scope
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#usage-and-impact">
   Usage and Impact
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#backward-compatibility">
   Backward compatibility
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#detailed-description">
   Detailed description
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#related-work">
   Related Work
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementation">
   Implementation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#alternatives">
   Alternatives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#discussion">
   Discussion
  </a>
 </li>
</ul>

</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  <section id="nxep-3-graph-builders">
<span id="nxep3"></span><h1>NXEP 3 — Graph Builders<a class="headerlink" href="#nxep-3-graph-builders" title="Permalink to this heading">#</a></h1>
<dl class="field-list simple">
<dt class="field-odd">Author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dan Schult</p>
</dd>
<dt class="field-even">Author<span class="colon">:</span></dt>
<dd class="field-even"><p>Kelly Boothby</p>
</dd>
<dt class="field-odd">Status<span class="colon">:</span></dt>
<dd class="field-odd"><p>Draft</p>
</dd>
<dt class="field-even">Type<span class="colon">:</span></dt>
<dd class="field-even"><p>Standards Track</p>
</dd>
<dt class="field-odd">Created<span class="colon">:</span></dt>
<dd class="field-odd"><p>2020-11-27</p>
</dd>
</dl>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this heading">#</a></h2>
<p>Graph generators in NetworkX create a Graph starting from an object
specified in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code> argument. Many of these generators
do no more than create edges to add to the graph. Sometimes all we
want the graph for is to generate those edges. It might be better
to allow generators to report either the <code class="xref py py-obj docutils literal notranslate"><span class="pre">edgelist</span></code> or any of the
standard graph classes or a custom class. This NXEP proposes a
framework for graph builders which allows a user friendly interface
to these features and decorators to make it easy for developers to
provide these features whether the graph builder algorithm requires
a graph, or just edges.</p>
</section>
<section id="motivation-and-scope">
<h2>Motivation and Scope<a class="headerlink" href="#motivation-and-scope" title="Permalink to this heading">#</a></h2>
<p>Consider, for example, the function <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph(nodes,</span> <span class="pre">create_using)</span></code>.
It creates the edges for the indicated path and adds them to an empty
graph data structure created using the type <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code>.
<code class="xref py py-obj docutils literal notranslate"><span class="pre">path_graph</span></code> does not use the graph structure to create the edges
being generated and could arguably just yield
the edges without involving the data structure at all.
The parameter <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code> is used to indicate the type of graph data
structure to use. This could be indicated by passing an edge generator
to the type constructor e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.MultiDiGraph(nx.path_edges(n))</span></code> instead
of <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph(n,</span> <span class="pre">create_using=nx.MultiDiGraph)</span></code>. The former style
allows the edges to be used without creating any graph data structure if
that is desired. The latter is preferred stylistically because the main
idea of the code phrase is to create a path graph and that comes first.
Details such as what graph type to use are specified later in the phrase.</p>
<p>Separating edge generation from graph data structure creation
arguably makes a cleaner interface where independent tools can be put
together in creative ways. To the extent that users need to generate
edges rather than graphs, having an edge generator that doesn’t store
the graph is an advantage. It’s not exactly clear how much demand there
is for this feature. But e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.utils.pairwise</span></code> would no longer be needed
if we had <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_edges(node_iterable)</span></code>.</p>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code> parameter is a mechanism to tell the function what
class of graph data structure to start with. Separating edge generation
from graph construction would mean the edge generator function would
no longer need a type for the graph data structure since there isn’t one.
This NXEP proposes one way to provide an interface that separates edge
generation from graph data structure creation when desired, while leaving
a user-friendly mechanism for selection the graph type when desired.</p>
<p>The changes proposed involve any nx function that creates a graph or an
edgelist. The proposal is to make these functions return a graph of
any type or an edgelist based on the choice indicated by the user.
Developers choose whether it is more effective to yield edges or to
return a graph. Decorators are used to construct the surrounding code
to enable the other output styles.</p>
<p>The proposed solution is to provide the user with graph builders that
return either a graph or an edgelist while minimizing the code needed
for developers to support both. The underlying code could choose to
either 1) yield edges, or 2) construct a graph from an input graph
parameter. Two decorators would then add the extra code needed to
construct a single object so users would use the same interface no
matter which style of underlying code was used. The user facing
interface would allow the user to specify a graph data structure
by type, or request an edgelist. One syntax proposal is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">DG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">MG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">MDG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">CG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="o">.</span><span class="n">CustomGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">create_using</span><span class="p">)</span>
<span class="n">elist</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="o">.</span><span class="n">edgelist</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
<p>Edgelists that only contain pairs of nodes indicating an edge are restrictive.
Some graphs have isolated nodes which would not appear in any node-pair.
Some graphs have node or edge attributes associated with the node or edge.
Multigraphs have edge keys associated with each edge, often as a 3-tuple
(u, v, ekey). This proposal suggests that we adopt the following edgelist
protocol for describing a graph (perhaps there is a better name than edgelist).</p>
<p>An edgelist is a sequence of containers. The length of the container along
with the hashable nature of it’s last element determined the type of
information included in the container. All currently used graph information
can be stored in such a sequence. The logic is as follows where C denotes
the container:</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>len(C)</p></th>
<th class="head"><p>hashable(C[-1])</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Graph attributes:</p></td>
<td><p>1</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>Node without attributes:</p></td>
<td><p>1</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p>Node with attributes:</p></td>
<td><p>2</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>Edge without attributes:</p></td>
<td><p>2</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p>Edge with attributes:</p></td>
<td><p>3</p></td>
<td><p>False</p></td>
</tr>
<tr class="row-odd"><td><p>Multiedge without attributes:</p></td>
<td><p>3</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p>Multiedge with attributes:</p></td>
<td><p>4</p></td>
<td><p>False</p></td>
</tr>
</tbody>
</table>
<p>Here is some code to process such an edgelist and construct the graph
starting from an empty graph G:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">C</span> <span class="ow">in</span> <span class="n">edgelist</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hashable</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">G</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># C[-1] is a dict of graph attributes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># C[-1] is a node</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hashable</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">**</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># C[-1] is a dict of node attributes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>  <span class="c1"># C is a node-pair indicating an edge</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">hashable</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">C</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="o">**</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># C -&gt; (u, v, attrdict)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>  <span class="c1"># C -&gt; (u, v, edge_key)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">hashable</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="o">*</span><span class="n">C</span><span class="p">)</span>  <span class="c1"># C -&gt; (u, v, edge_key, attr_dict)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NetworkXInvalidEdgelist</span><span class="p">(</span>
            <span class="s2">&quot;no container in an edgelist should be larger than 4 objects.&quot;</span>
        <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="usage-and-impact">
<h2>Usage and Impact<a class="headerlink" href="#usage-and-impact" title="Permalink to this heading">#</a></h2>
<p>Users will build graphs using similar syntax as before with added flexibility.</p>
<p>Create a wheel graph with 9 spokes (10 nodes):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">wheel_graph</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="c1"># same as current code</span>
</pre></div>
</div>
<p>Construct a path graph using a MultiDiGraph data structure:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">MDG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># current code:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MDG</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">path_graph</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">create_using</span><span class="o">=</span><span class="n">MultiDiGraph</span><span class="p">)</span>
</pre></div>
</div>
<p>Construct a star graph using a CustomGraph subclass of a NetworkX graph class.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">star_graph</span><span class="o">.</span><span class="n">CustomGraph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">MyCustomGraph</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># current code:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">star_graph</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">MyCustomGraph</span><span class="p">)</span>
</pre></div>
</div>
<p>Add a complete graph to an existing graph G:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">complete_graph</span><span class="o">.</span><span class="n">edgelist</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">-</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<p>Iterate over the edges of a randomly generated graph without storing it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">configuration_model_graph</span><span class="o">.</span><span class="n">edgelist</span><span class="p">(</span><span class="n">deg_sequence</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">process</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>Developers will use a decorator to indicate whether their graph builder
has underlying code that yields from an edgelist, or returns a graph.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@graph_builder</span>
<span class="nd">@py_random_state</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">extended_barabasi_albert_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># some fancy code that requires we construct G to use graph properties</span>
    <span class="c1"># while we decide what edges to add next.</span>
    <span class="k">return</span> <span class="n">G</span>
</pre></div>
</div>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;graph_builder</span></code> decorator adds code to enable
e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.extended_barabasi_albert_graph.edgelist</span></code>.</p>
<p>For most graph builders we simply yield from an edgelist.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@node_and_edge_builder</span>
<span class="k">def</span> <span class="nf">ladder_graph</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">yield from</span> <span class="n">pairwise</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="k">yield from</span> <span class="n">pairwise</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">yield from</span> <span class="p">((</span><span class="n">v</span><span class="p">,</span> <span class="n">v</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<p>The <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;node_and_edge_builder</span></code> decorator adds code to enable
e.g. <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.ladder_graph.MultiGraph(6)</span></code>. Note that <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.ladder_graph(6)</span></code>
would still return an nx.Graph as it currently does. To make use of the
edgelist functionality yielding edge without graph constructing, the syntax
would be <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.ladder_graph.edgelist(6)</span></code>.</p>
</section>
<section id="backward-compatibility">
<h2>Backward compatibility<a class="headerlink" href="#backward-compatibility" title="Permalink to this heading">#</a></h2>
<p>To reduce backward incompatibility, the base calling structure <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph(9)</span></code>
works as it currently does. The <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code> parameter is removed and
replaced by an attribute of the calling function.
So <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph(9,</span> <span class="pre">nx.DiGraph)</span></code> becomes <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph.DiGraph(9)</span></code>.
The <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code> parameter could also be retained providing more backward
compatibility at the potential cost of providing at least 2 ways to create
the same graph: <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph(9,</span> <span class="pre">create_using=nx.DiGraph)</span></code>
and <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph.DiGraph(9)</span></code>. See the Alternatives section.</p>
<p>Due to the renaming of graph generators as graph builders (to avoid confusion
with Python’s generator functions) anyone using full-path calling syntax
e.g., <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.generators.path_graph(9)</span></code> will need to change to <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.path_graph(9)</span></code>
or <code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.builders.path_graph(9)</span></code> though the latter is discouraged.
This change of name is independent of the main thrust of this proposal.
But it seems a reasonable time to make such a change.</p>
<p>To reduce developer impact, upon inception, we could use all current graph
generators as graph builders by attaching the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;graph_builder</span></code> decorator.
Presumably for efficiency many of them should be rewritten to yield
edgelists rather than returning graphs. But this could be done gradually
and when done switch the decorator to <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;node_and_edge_builder</span></code>. Both should
return equivalent graph builder objects.</p>
</section>
<section id="detailed-description">
<h2>Detailed description<a class="headerlink" href="#detailed-description" title="Permalink to this heading">#</a></h2>
<p>This can be accomplished through a couple decorators, which could be
adopted gradually – a big patch initially decorating all existing generators
with <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;graph_builder</span></code> would immediately support the notation
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.complete_graph.edgelist(...)</span></code> without impacting existing code.
Later generators could use <code class="xref py py-obj docutils literal notranslate"><span class="pre">&#64;node_and_edge_builder</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">node_and_edge_builder</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">digraph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">multigraph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">multidigraph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">custom_graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">create_using</span><span class="p">()</span>
        <span class="n">g</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">g</span>

    <span class="n">graph</span><span class="o">.</span><span class="n">Graph</span> <span class="o">=</span> <span class="n">graph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">digraph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">MultiGraph</span> <span class="o">=</span> <span class="n">multigraph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">MultiDiGraph</span> <span class="o">=</span> <span class="n">multidigraph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">CustomGraph</span> <span class="o">=</span> <span class="n">custom_graph</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">edgelist</span> <span class="o">=</span> <span class="n">f</span>
    <span class="k">return</span> <span class="n">graph</span>


<span class="k">def</span> <span class="nf">graph_builder</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">edgelist</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">itertools</span><span class="o">.</span><span class="n">ichain</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">data</span><span class="p">()),</span> <span class="nb">map</span><span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">data</span><span class="p">()))</span>

    <span class="n">f</span><span class="o">.</span><span class="n">edgelist</span> <span class="o">=</span> <span class="n">edgelist</span>
    <span class="n">f</span><span class="o">.</span><span class="n">CustomGraph</span> <span class="o">=</span> <span class="n">f</span>

    <span class="k">def</span> <span class="nf">graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">digraph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">multigraph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">MultiGraph</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">multidigraph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">MultiDiGraph</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">f</span><span class="o">.</span><span class="n">Graph</span> <span class="o">=</span> <span class="n">graph</span>
    <span class="n">f</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">=</span> <span class="n">digraph</span>
    <span class="n">f</span><span class="o">.</span><span class="n">MultiGraph</span> <span class="o">=</span> <span class="n">multigraph</span>
    <span class="n">f</span><span class="o">.</span><span class="n">MultiDiGraph</span> <span class="o">=</span> <span class="n">multidigraph</span>
    <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
<p>Note: the graph_builder underlying code should accept a create_using
parameter for this implementation to work. We need to think if this is
universally applicable and how to handle builders that shouldn’t work
with all four of the major NetworkX graph classes.</p>
<p>Graph.update will need to handle an edgelist input. It currently handles
node-pairs and node-pair with edge key triples for multigraphs. Code like
that shown above in the description of Edgelist should be used.</p>
<p>Example developer usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@node_and_edge_builder</span>
<span class="k">def</span> <span class="nf">path_graph</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;an overly simplified path graph implementation&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">pairwise</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>


<span class="nd">@graph_builder</span>
<span class="k">def</span> <span class="nf">complete_graph</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">create_using</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;an overly simplified complete graph implementation&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">create_using</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">create_using</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">empty_graph</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">create_using</span><span class="p">)</span>
    <span class="n">g</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">g</span>
</pre></div>
</div>
</section>
<section id="related-work">
<h2>Related Work<a class="headerlink" href="#related-work" title="Permalink to this heading">#</a></h2>
<p>This proposal is based on ideas and discussions from #3036 and #1393.</p>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this heading">#</a></h2>
<p>The first major step is to implement the two builder decorators.
Next we need to change the Graph update methods, convert functions, etc.
to process edgelists that contain isolated nodes and data attributes.
Third we should identify any functions that build graphs or edgelists
and decorate them to make them Graph Builders.</p>
<p>Special care should be made to ensure only desired graph types are
accepted and appropriate errors raised when not.</p>
<p>We should rename the generators directory as builders and adjust
documentation where needed appropriately (including old documentation
getting the correct canonical url).</p>
<p>Later steps include going through the existing generator code and switching
that code to yield edgelists instead of returning graphs (where appropriate).</p>
</section>
<section id="alternatives">
<h2>Alternatives<a class="headerlink" href="#alternatives" title="Permalink to this heading">#</a></h2>
<p>We can just leave the generators as they are and deal with the cost of
creating a graph when one only needs the edgelist. It’s not a huge cost
most of the time.</p>
<p>We can split the edge generation from graph creation using
<code class="xref py py-obj docutils literal notranslate"><span class="pre">nx.DiGraph(nx.path_edgelist(9))</span></code> and disallowing <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code>.</p>
<p>We can implement the proposal retaining the <code class="xref py py-obj docutils literal notranslate"><span class="pre">create_using</span></code> parameter
for backward compatibility.</p>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Permalink to this heading">#</a></h2>
<p>Most of the ideas here are from
- [<code class="xref py py-obj docutils literal notranslate"><span class="pre">#3036</span></code>]
which built on discussion from
- [<code class="xref py py-obj docutils literal notranslate"><span class="pre">#1393</span></code>]</p>
</section>
</section>


              </article>
              

              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2004-2022, NetworkX Developers.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>